<!DOCTYPE html>
<html>
  <head>
    <title>JS Essentials Quiz</title>
    <meta charset="utf-8" />
    <link
      href="https://unpkg.com/survey-core/survey-core.min.css"
      type="text/css"
      rel="stylesheet"
    />
    <style>
      .feedback-correct {
        color: #28a745;
        background-color: #d4edda;
        border: 1px solid #c3e6cb;
        padding: 10px;
        margin: 10px 0;
        border-radius: 4px;
        animation: fadeIn 0.5s ease-in;
      }
      .feedback-incorrect {
        color: #dc3545;
        background-color: #f8d7da;
        border: 1px solid #f5c6cb;
        padding: 10px;
        margin: 10px 0;
        border-radius: 4px;
        animation: fadeIn 0.5s ease-in;
      }
      .feedback-explanation {
        background-color: #f8f9fa;
        border-left: 4px solid #007bff;
        padding: 10px;
        margin: 10px 0;
        border-radius: 4px;
        font-style: italic;
      }
      .question-feedback {
        margin-top: 15px;
        padding: 15px;
        border-radius: 5px;
        border-left: 4px solid;
      }
      .question-feedback.correct {
        background-color: #f8fff9;
        border-left-color: #28a745;
      }
      .question-feedback.incorrect {
        background-color: #fff8f8;
        border-left-color: #dc3545;
      }
      .detailed-results {
        margin-top: 20px;
        padding: 20px;
        background-color: #f8f9fa;
        border-radius: 8px;
      }
      .missed-questions {
        margin-top: 15px;
      }
      .question-item {
        margin-bottom: 15px;
        padding: 10px;
        background-color: white;
        border-radius: 5px;
        border: 1px solid #dee2e6;
      }
      .question-title {
        font-weight: bold;
        margin-bottom: 8px;
      }
      .correct-answer {
        color: #28a745;
        font-weight: bold;
      }
      .user-answer {
        color: #dc3545;
        font-style: italic;
      }
      .explanation {
        margin-top: 8px;
        color: #6c757d;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(-10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .feedback-container {
        margin-top: 15px;
        padding: 15px;
        border-radius: 8px;
        border: 2px solid;
        transition: all 0.3s ease;
      }
      .feedback-container.correct {
        border-color: #28a745;
        background-color: #f8fff9;
      }
      .feedback-container.incorrect {
        border-color: #dc3545;
        background-color: #fff8f8;
      }
      .feedback-icon {
        font-size: 1.2em;
        margin-right: 8px;
      }
      .next-question-btn {
        background-color: #007bff;
        color: white;
        border: none;
        padding: 8px 16px;
        border-radius: 4px;
        cursor: pointer;
        margin-top: 10px;
        transition: background-color 0.3s ease;
      }
      .next-question-btn:hover {
        background-color: #0056b3;
      }
      .score-display {
        position: fixed;
        top: 20px;
        right: 20px;
        background-color: #007bff;
        color: white;
        padding: 10px 15px;
        border-radius: 20px;
        font-weight: bold;
        z-index: 1000;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }
    </style>

    <script
      type="text/javascript"
      src="https://unpkg.com/survey-core/survey.core.min.js"
    ></script>
    <script
      type="text/javascript"
      src="https://unpkg.com/survey-js-ui/survey-js-ui.min.js"
    ></script>
  </head>
  <body>
    <div id="surveyContainer"></div>
    <div id="scoreDisplay" class="score-display" style="display: none">
      Score: <span id="currentScore">0</span> /
      <span id="totalQuestions">0</span>
    </div>
    <script>
      const surveyJson = {
        title: "JavaScript Essentials Quiz",
        description:
          "Test your knowledge of JavaScript fundamentals including functions, async programming, arrays, destructuring, modules, and Node.js.",
        questions: [
          {
            type: "radiogroup",
            name: "function_syntax",
            title: "Which function syntax is hoisted in JavaScript?",
            choices: [
              "Function declaration",
              "Function expression",
              "Arrow function",
              "All of the above",
            ],
            correctAnswer: "Function declaration",
            explanation:
              "Function declarations are hoisted, meaning they can be called before they are defined in the code. Function expressions and arrow functions are not hoisted.",
            feedback: {
              correct:
                "✅ Correct! Function declarations are hoisted, which means they can be called before they are defined in the code.",
              incorrect:
                "❌ Incorrect. Function declarations are the only function syntax that gets hoisted. Function expressions and arrow functions are not hoisted and must be defined before use.",
            },
          },
          {
            type: "radiogroup",
            name: "arrow_function_this",
            title:
              "What does the 'this' keyword refer to in an arrow function?",
            choices: [
              "The object that calls the function",
              "The parent's context (lexical scoping)",
              "The global window object",
              "It depends on how the function is called",
            ],
            correctAnswer: "The parent's context (lexical scoping)",
            explanation:
              "Arrow functions use lexical scoping for 'this', meaning they inherit the 'this' value from their parent scope, unlike regular functions.",
            feedback: {
              correct:
                "✅ Correct! Arrow functions use lexical scoping for 'this', inheriting the 'this' value from their parent scope.",
              incorrect:
                "❌ Incorrect. Arrow functions use lexical scoping for 'this', not dynamic binding like regular functions. They inherit 'this' from their parent scope.",
            },
          },
          {
            type: "radiogroup",
            name: "first_class_functions",
            title:
              "What does it mean for functions to be 'first-class' in JavaScript?",
            choices: [
              "They can only be called once",
              "They can be passed to other functions and returned by functions",
              "They must be declared before use",
              "They can only be used in the global scope",
            ],
            correctAnswer:
              "They can be passed to other functions and returned by functions",
            explanation:
              "First-class functions can be treated like any other value - they can be assigned to variables, passed as arguments, and returned from other functions.",
            feedback: {
              correct:
                "✅ Correct! First-class functions can be treated like any other value - assigned to variables, passed as arguments, and returned from other functions.",
              incorrect:
                "❌ Incorrect. First-class functions can be used multiple times, don't need to be declared before use, and can be used in any scope. They can be passed to and returned from other functions.",
            },
          },
          {
            type: "radiogroup",
            name: "callback_order",
            title:
              "In this code, what will be the order of console.log outputs?\n\n```javascript\nfunction fetchData(callback) {\n  console.log('Fetching data...');\n  setTimeout(() => {\n    callback('Data received');\n  }, 2000);\n}\n\nfetchData((result) => {\n  console.log(result);\n});\nconsole.log('Script end');\n```",
            choices: [
              "Fetching data..., Script end, Data received",
              "Fetching data..., Data received, Script end",
              "Script end, Fetching data..., Data received",
              "Data received, Fetching data..., Script end",
            ],
            correctAnswer: "Fetching data..., Script end, Data received",
            explanation:
              "The setTimeout callback is asynchronous and will execute after the 2-second delay, while the rest of the code continues executing immediately.",
            feedback: {
              correct:
                "✅ Correct! The setTimeout callback is asynchronous and executes after the 2-second delay, while synchronous code continues immediately.",
              incorrect:
                "❌ Incorrect. Remember that setTimeout is asynchronous - it schedules the callback for later execution while the rest of the code continues immediately.",
            },
          },
          {
            type: "radiogroup",
            name: "promise_states",
            title: "Which of the following is NOT a valid Promise state?",
            choices: ["pending", "fulfilled", "rejected", "completed"],
            correctAnswer: "completed",
            explanation:
              "Promises have three states: pending (initial state), fulfilled (successfully completed), and rejected (failed). 'completed' is not a valid Promise state.",
            feedback: {
              correct:
                "✅ Correct! Promises have only three states: pending, fulfilled, and rejected. 'completed' is not a valid Promise state.",
              incorrect:
                "❌ Incorrect. Promises have exactly three states: pending (initial), fulfilled (success), and rejected (failure). 'completed' is not a valid state.",
            },
          },
          {
            type: "radiogroup",
            name: "async_await",
            title:
              "What is the main advantage of using async/await over promises?",
            choices: [
              "Better performance",
              "More readable, synchronous-looking code",
              "Smaller file size",
              "Better browser compatibility",
            ],
            correctAnswer: "More readable, synchronous-looking code",
            explanation:
              "async/await allows you to write asynchronous code that looks and behaves more like synchronous code, making it easier to read and understand.",
            feedback: {
              correct:
                "✅ Correct! async/await makes asynchronous code look and behave more like synchronous code, improving readability and maintainability.",
              incorrect:
                "❌ Incorrect. async/await doesn't improve performance or file size, and has similar browser compatibility to promises. Its main advantage is improved readability.",
            },
          },
          {
            type: "radiogroup",
            name: "array_methods",
            title:
              "Which array method is used to transform each element in an array?",
            choices: ["filter()", "map()", "reduce()", "find()"],
            correctAnswer: "map()",
            explanation:
              "The map() method creates a new array with the results of calling a function for every array element, effectively transforming each element.",
            feedback: {
              correct:
                "✅ Correct! map() transforms each element in an array by applying a function to it and returning a new array with the results.",
              incorrect:
                "❌ Incorrect. filter() selects elements, reduce() combines elements into a single value, and find() finds the first matching element. map() transforms each element.",
            },
          },
          {
            type: "radiogroup",
            name: "array_chain",
            title:
              "What will be the output of this code?\n\n```javascript\nconst numbers = [1, 2, 3, 4, 5];\nconst result = numbers\n  .filter(n => n > 2)\n  .map(n => n * 2)\n  .reduce((sum, n) => sum + n, 0);\nconsole.log(result);\n```",
            choices: ["14", "15", "18", "20"],
            correctAnswer: "18",
            explanation:
              "filter(n > 2) gives [3,4,5], map(n * 2) gives [6,8,10], reduce(sum + n) gives 6+8+10 = 18.",
            feedback: {
              correct:
                "✅ Correct! filter(n > 2) gives [3,4,5], map(n * 2) gives [6,8,10], reduce(sum + n) gives 6+8+10 = 18.",
              incorrect:
                "❌ Incorrect. Let's break it down: filter(n > 2) gives [3,4,5], map(n * 2) gives [6,8,10], reduce(sum + n) gives 6+8+10 = 18.",
            },
          },
          {
            type: "radiogroup",
            name: "destructuring_object",
            title: "What is the correct syntax for object destructuring?",
            choices: [
              "const {name, age} = person;",
              "const [name, age] = person;",
              "const name, age = person;",
              "const {name: age} = person;",
            ],
            correctAnswer: "const {name, age} = person;",
            explanation:
              "Object destructuring uses curly braces {} to extract properties from objects, while array destructuring uses square brackets [].",
            feedback: {
              correct:
                "✅ Correct! Object destructuring uses curly braces {} to extract properties from objects.",
              incorrect:
                "❌ Incorrect. Object destructuring uses curly braces {}, not square brackets []. Square brackets are for array destructuring.",
            },
          },
          {
            type: "radiogroup",
            name: "spread_operator",
            title: "What does the spread operator (...) do?",
            choices: [
              "Creates a copy of an array or object",
              "Combines multiple arrays or objects",
              "Both of the above",
              "Neither of the above",
            ],
            correctAnswer: "Both of the above",
            explanation:
              "The spread operator can be used to create shallow copies and combine arrays/objects. It 'spreads' the elements/properties into a new structure.",
            feedback: {
              correct:
                "✅ Correct! The spread operator can both create copies and combine arrays/objects by spreading their elements/properties.",
              incorrect:
                "❌ Incorrect. The spread operator can do both - it creates shallow copies and combines arrays/objects by spreading their contents.",
            },
          },
          {
            type: "radiogroup",
            name: "es6_modules",
            title:
              "Which is the correct way to export a function in ES6 modules?",
            choices: [
              "export function myFunction() {}",
              "module.exports = myFunction;",
              "exports.myFunction = myFunction;",
              "All of the above",
            ],
            correctAnswer: "export function myFunction() {}",
            explanation:
              "ES6 modules use the 'export' keyword, while CommonJS uses 'module.exports'. The 'export' syntax is the modern ES6 approach.",
            feedback: {
              correct:
                "✅ Correct! ES6 modules use the 'export' keyword for named exports.",
              incorrect:
                "❌ Incorrect. module.exports and exports are CommonJS syntax. ES6 modules use the 'export' keyword.",
            },
          },
          {
            type: "radiogroup",
            name: "import_syntax",
            title: "What is the correct syntax to import a default export?",
            choices: [
              "import { MyClass } from './module.js';",
              "import MyClass from './module.js';",
              "import * as MyClass from './module.js';",
              "import MyClass, { otherExport } from './module.js';",
            ],
            correctAnswer: "import MyClass from './module.js';",
            explanation:
              "Default exports are imported without curly braces. Named exports use curly braces, and you can combine both in one import statement.",
            feedback: {
              correct:
                "✅ Correct! Default exports are imported without curly braces, while named exports use curly braces.",
              incorrect:
                "❌ Incorrect. Default exports don't use curly braces. Named exports use curly braces, and you can combine both in one import.",
            },
          },
          {
            type: "radiogroup",
            name: "node_runtime",
            title: "What is Node.js?",
            choices: [
              "A JavaScript framework",
              "A JavaScript runtime built on Chrome's V8 engine",
              "A package manager",
              "A code editor",
            ],
            correctAnswer: "A JavaScript runtime built on Chrome's V8 engine",
            explanation:
              "Node.js is a JavaScript runtime that allows you to run JavaScript on the server-side, built on Chrome's V8 JavaScript engine.",
            feedback: {
              correct:
                "✅ Correct! Node.js is a JavaScript runtime built on Chrome's V8 engine that allows server-side JavaScript execution.",
              incorrect:
                "❌ Incorrect. Node.js is not a framework, package manager, or code editor. It's a JavaScript runtime built on Chrome's V8 engine.",
            },
          },
          {
            type: "radiogroup",
            name: "npm_purpose",
            title: "What does npm stand for?",
            choices: [
              "Node Package Manager",
              "Node Program Manager",
              "Network Package Manager",
              "Node Project Manager",
            ],
            correctAnswer: "Node Package Manager",
            explanation:
              "npm stands for Node Package Manager. It's the default package manager for Node.js and helps manage dependencies and scripts.",
            feedback: {
              correct:
                "✅ Correct! npm stands for Node Package Manager, the default package manager for Node.js.",
              incorrect:
                "❌ Incorrect. npm stands for Node Package Manager, not Node Program Manager, Network Package Manager, or Node Project Manager.",
            },
          },
          {
            type: "radiogroup",
            name: "package_json",
            title: "What is the purpose of package.json?",
            choices: [
              "To store project dependencies and scripts",
              "To configure the Node.js runtime",
              "To define HTML templates",
              "To store user preferences",
            ],
            correctAnswer: "To store project dependencies and scripts",
            explanation:
              "package.json is a manifest file that contains project metadata, dependencies, scripts, and other configuration for Node.js projects.",
            feedback: {
              correct:
                "✅ Correct! package.json is a manifest file that stores project metadata, dependencies, and scripts.",
              incorrect:
                "❌ Incorrect. package.json doesn't configure Node.js runtime, define HTML templates, or store user preferences. It stores project dependencies and scripts.",
            },
          },
          {
            type: "checkbox",
            name: "array_methods_check",
            title:
              "Which of the following array methods return a new array? (Select all that apply)",
            choices: ["map()", "filter()", "reduce()", "slice()", "push()"],
            correctAnswer: ["map()", "filter()", "slice()"],
            explanation:
              "map(), filter(), and slice() return new arrays. reduce() returns a single value, and push() modifies the original array.",
            feedback: {
              correct:
                "✅ Correct! map(), filter(), and slice() return new arrays without modifying the original.",
              incorrect:
                "❌ Incorrect. map(), filter(), and slice() return new arrays. reduce() returns a single value, and push() modifies the original array.",
            },
          },
          {
            type: "checkbox",
            name: "async_patterns",
            title:
              "Which of the following are valid ways to handle asynchronous operations in JavaScript? (Select all that apply)",
            choices: [
              "Callbacks",
              "Promises",
              "async/await",
              "Synchronous loops",
              "Event listeners",
            ],
            correctAnswer: [
              "Callbacks",
              "Promises",
              "async/await",
              "Event listeners",
            ],
            explanation:
              "Callbacks, promises, async/await, and event listeners are all valid ways to handle asynchronous operations. Synchronous loops are not asynchronous.",
            feedback: {
              correct:
                "✅ Correct! Callbacks, promises, async/await, and event listeners are all valid asynchronous patterns.",
              incorrect:
                "❌ Incorrect. Synchronous loops are not asynchronous. Callbacks, promises, async/await, and event listeners are valid async patterns.",
            },
          },
          {
            type: "text",
            name: "function_definition",
            title:
              "Write a simple arrow function that takes a name parameter and returns 'Hello, [name]!'",
            correctAnswer: "const greet = (name) => `Hello, ${name}!`;",
            explanation:
              "This arrow function uses template literals to create a greeting string. Alternative valid answers include: (name) => 'Hello, ' + name + '!' or name => `Hello, ${name}!`",
            feedback: {
              correct:
                "✅ Correct! This arrow function uses template literals to create a greeting string.",
              incorrect:
                "❌ Incorrect. Remember to use arrow function syntax (=>) and template literals (`) for string interpolation.",
            },
          },
          {
            type: "text",
            name: "array_method_chain",
            title:
              "Complete this code to get the sum of all even numbers doubled:\n\n```javascript\nconst numbers = [1, 2, 3, 4, 5, 6];\nconst result = numbers\n  .filter(/* your code here */)\n  .map(/* your code here */)\n  .reduce(/* your code here */, 0);\n```",
            correctAnswer:
              ".filter(n => n % 2 === 0).map(n => n * 2).reduce((sum, n) => sum + n, 0)",
            explanation:
              "Filter for even numbers (n % 2 === 0), map to double them (n * 2), then reduce to sum them up starting from 0.",
            feedback: {
              correct:
                "✅ Correct! You successfully chained filter, map, and reduce to process the array.",
              incorrect:
                "❌ Incorrect. Remember: filter for even numbers (n % 2 === 0), map to double them (n * 2), then reduce to sum starting from 0.",
            },
          },
        ],
        showQuestionNumbers: true,
        showProgressBar: true,
        pageNextText: "Next",
        pagePrevText: "Previous",
        completeText: "Submit Quiz",
        requiredText: "*",
        questionStartIndex: "1",
        showCompletedPage: true,
        completedHtml:
          "<h3>Thank you for completing the JavaScript Essentials Quiz!</h3><p>Your score: <b>{correctAnswers}</b> out of <b>{questionCount}</b></p><div id='detailed-feedback'></div>",
      };

      const survey = new Survey.Model(surveyJson);
      let currentScore = 0;
      let answeredQuestions = new Set();

      // Function to check if answer is correct
      function isAnswerCorrect(question, userAnswer) {
        if (question.type === "checkbox") {
          if (
            !Array.isArray(userAnswer) ||
            !Array.isArray(question.correctAnswer)
          ) {
            return false;
          }
          return (
            userAnswer.length === question.correctAnswer.length &&
            userAnswer.every((answer) =>
              question.correctAnswer.includes(answer)
            )
          );
        } else if (question.type === "text") {
          return (
            userAnswer &&
            userAnswer.trim().toLowerCase() ===
              question.correctAnswer.toLowerCase()
          );
        } else {
          return userAnswer === question.correctAnswer;
        }
      }

      // Function to format user answer for display
      function formatUserAnswer(question, userAnswer) {
        if (question.type === "checkbox") {
          return Array.isArray(userAnswer)
            ? userAnswer.join(", ")
            : "No answer";
        } else if (question.type === "text") {
          return userAnswer || "No answer";
        } else {
          return userAnswer || "No answer";
        }
      }

      // Function to format correct answer for display
      function formatCorrectAnswer(question) {
        if (question.type === "checkbox") {
          return Array.isArray(question.correctAnswer)
            ? question.correctAnswer.join(", ")
            : question.correctAnswer;
        } else {
          return question.correctAnswer;
        }
      }

      // Function to show feedback for a question
      function showQuestionFeedback(question, userAnswer, isCorrect) {
        const questionElement = document.querySelector(
          `[data-name="${question.name}"]`
        );
        if (!questionElement) return;

        // Remove existing feedback
        const existingFeedback = questionElement.querySelector(
          ".feedback-container"
        );
        if (existingFeedback) {
          existingFeedback.remove();
        }

        // Create feedback container
        const feedbackContainer = document.createElement("div");
        feedbackContainer.className = `feedback-container ${
          isCorrect ? "correct" : "incorrect"
        }`;

        // Get feedback message
        const feedbackMessage = isCorrect
          ? question.feedback?.correct || "✅ Correct!"
          : question.feedback?.incorrect || "❌ Incorrect.";

        feedbackContainer.innerHTML = `
          <div class="feedback-icon">${isCorrect ? "✅" : "❌"}</div>
          <div><strong>${feedbackMessage}</strong></div>
          <div class="feedback-explanation">
            <strong>Explanation:</strong> ${question.explanation}
          </div>
          ${
            !isCorrect
              ? `<div><strong>Your answer:</strong> ${formatUserAnswer(
                  question,
                  userAnswer
                )}</div>
          <div><strong>Correct answer:</strong> ${formatCorrectAnswer(
            question
          )}</div>`
              : ""
          }
        `;

        // Insert feedback after the question
        questionElement.appendChild(feedbackContainer);

        // Scroll to feedback
        feedbackContainer.scrollIntoView({
          behavior: "smooth",
          block: "center",
        });
      }

      // Function to update score display
      function updateScoreDisplay() {
        const scoreDisplay = document.getElementById("scoreDisplay");
        const currentScoreSpan = document.getElementById("currentScore");
        const totalQuestionsSpan = document.getElementById("totalQuestions");

        if (scoreDisplay && currentScoreSpan && totalQuestionsSpan) {
          currentScoreSpan.textContent = currentScore;
          totalQuestionsSpan.textContent = survey.getAllQuestions().length;
          scoreDisplay.style.display = "block";
        }
      }

      // Handle question value changes
      survey.onValueChanged.add(function (sender, options) {
        const question = options.question;
        const userAnswer = options.value;

        // Skip if already answered
        if (answeredQuestions.has(question.name)) return;

        // Check if answer is correct
        const isCorrect = isAnswerCorrect(question, userAnswer);

        // Update score
        if (isCorrect) {
          currentScore++;
        }

        // Mark question as answered
        answeredQuestions.add(question.name);

        // Show feedback
        showQuestionFeedback(question, userAnswer, isCorrect);

        // Update score display
        updateScoreDisplay();

        // Disable the question after answering
        question.readOnly = true;
      });

      // Enhanced completion handler
      function handleQuizCompletion(sender) {
        const results = sender.data;
        const questions = survey.getAllQuestions();
        let missedQuestions = [];

        questions.forEach((question) => {
          const userAnswer = results[question.name];
          const isCorrect = isAnswerCorrect(question, userAnswer);

          if (!isCorrect) {
            missedQuestions.push({
              question: question,
              userAnswer: userAnswer,
              isCorrect: false,
            });
          }
        });

        // Create detailed feedback HTML
        let feedbackHtml = `
          <div class="detailed-results">
            <h4>�� Detailed Results</h4>
            <p><strong>Final Score:</strong> ${currentScore} out of ${
          questions.length
        } (${Math.round((currentScore / questions.length) * 100)}%)</p>
        `;

        if (missedQuestions.length > 0) {
          feedbackHtml += `
            <div class="missed-questions">
              <h5>❌ Questions You Missed:</h5>
          `;

          missedQuestions.forEach((item, index) => {
            const question = item.question;
            feedbackHtml += `
              <div class="question-item">
                <div class="question-title">Question ${index + 1}: ${
              question.title
            }</div>
                <div class="user-answer">Your answer: ${formatUserAnswer(
                  question,
                  item.userAnswer
                )}</div>
                <div class="correct-answer">Correct answer: ${formatCorrectAnswer(
                  question
                )}</div>
                <div class="explanation"><strong>Explanation:</strong> ${
                  question.explanation
                }</div>
              </div>
            `;
          });

          feedbackHtml += `</div>`;
        } else {
          feedbackHtml += `<p>🎉 Perfect score! Great job!</p>`;
        }

        feedbackHtml += `</div>`;

        // Insert the feedback into the completed page
        setTimeout(() => {
          const feedbackContainer =
            document.getElementById("detailed-feedback");
          if (feedbackContainer) {
            feedbackContainer.innerHTML = feedbackHtml;
          }
        }, 100);
      }

      survey.onComplete.add(handleQuizCompletion);

      document.addEventListener("DOMContentLoaded", function () {
        survey.render(document.getElementById("surveyContainer"));
        updateScoreDisplay();
      });
    </script>
  </body>
</html>
